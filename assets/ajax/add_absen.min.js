var $ = jQuery.noConflict();
$(document).ready(function() {
    function load_data() {
        $.ajax({
            url: rootWebService + "CaddyMaster/fetch",
            method: "POST",
            success: function(data) {
                $("#absen_data").html(data);
                console.log(data);
            }, //success
            error: function(xhr, ajaxOption, thrownError) {
                Notiflix.Report.Failure(
                    "Terjadi Kesalahan !",
                    "Server tidak merespon permintaan !! - System<br>",
                    "Tutup"
                );
            }, //error
        });
    }

    $("#import_form").on("submit", function(event) {
        event.preventDefault();
        $("#file_named").removeClass("object_error");
        $.ajax({
            url: rootWebService + "CaddyMaster/import",
            method: "POST",
            data: new FormData(this),
            contentType: false,
            cache: false,
            processData: false,
            success: function(data) {
                var msg = data.msg;
                var err = data.err;

                if (msg === "SUCCESS") {
                    Notiflix.Report.Success(
                        "Import Berhasil !",
                        "Inport Data Absensi Caddy Berhasil Dilakukan",
                        "Tutup"
                    );
                    $("form :input").val("");
                    load_data();
                } else if (msg === "FAIL_UPLOAD") {
                    Notiflix.Report.Warning("Terjadi Kesalahan !", err, "Tutup");
                    $("#file_named").addClass("object_error");
                }
            }, //success
            error: function(xhr, ajaxOption, thrownError) {
                Notiflix.Report.Failure(
                    "Terjadi Kesalahan !",
                    "Server tidak merespon permintaan !! - System<br>",
                    "Tutup"
                );
            }, //error
        });
    });

    $("#hapus_form").on("submit", function(event) {
        event.preventDefault();

        $.ajax({
            url: rootWebService + "CaddyMaster/hapus_absen",
            method: "POST",
            data: new FormData(this),
            contentType: false,
            cache: false,
            processData: false,
            success: function(data) {
                var msg = data.msg;

                if (msg === "DELETE_OK") {
                    Notiflix.Report.Success(
                        "Berhasil !",
                        "Data Absen Berhasil Dihapus !",
                        "Tutup"
                    );
                } else if (msg === "EMPTY") {
                    Notiflix.Report.Warning(
                        "Terjadi Kesalahan !",
                        "Data yang dipilih tidak ada !",
                        "Tutup"
                    );
                } else if (msg === "WORNG") {
                    Notiflix.Report.Failure(
                        "Terjadi Kesalahan !",
                        "Data yang dimasukkan tidak benar !",
                        "Tutup"
                    );
                }
            }, //success
            error: function(xhr, ajaxOption, thrownError) {
                Notiflix.Report.Failure(
                    "Terjadi Kesalahan !",
                    "Server tidak merespon permintaan !! - System<br>",
                    "Tutup"
                );
            }, //error
        });
    });
});